/** 
 * genie - v0.3.0 @license
 * (c) 2013-12-31 - Kent C. Dodds <kent@doddsfamily.us>
 * A JavaScript library committed to improving user experience by empowering users to interact with web apps using the keyboard (better than cryptic shortcuts).
 * Freely distributed under the MIT license
 * https://github.com/kentcdodds/genie
 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b):a.genie=b()}(this,function(){"use strict";function a(c){if(C(c)){var d=[];return B(c,function(b){d.push(a(b))}),d}var e=c.id||"g-"+Y++,f={id:e,context:c.context||$,data:c.data||{},magicWords:t(c.magicWords),action:b(c.action)};return f.data.timesMade=0,X[e]=f,X[e]}function b(a){return D(a)&&(a={destination:a}),E(a)?function(){a.openNewTab?window.open(a.destination,"_blank"):window.location.href=a.destination}:a}function c(a){E(a)&&a.id&&(a=a.id);var b=X[a];return delete X[a],B(Z,function(b,c){-1!==b.indexOf(a)&&Z[c].splice(b.indexOf(a),1),Z[c].length||delete Z[c]}),b}function d(a){var b=e(a);return B(b,function(a,d){b[d]=c(a)}),b}function e(a){a=a||$;var b=[];return B(X,function(c){p(c,a)&&b.push(c)}),b}function f(a){if(C(a)){var b=[];return B(a,function(a){b.push(X[a])}),b}return X[a]}function g(){var a=J();return J({wishes:{},noWishMerge:!0,previousId:0,enteredMagicWords:{},context:$,previousContext:$,enabled:!0}),a}function h(a){a=a||"";var b=Z[a]||[],c=i(b,a);b=b.concat(c);var d=[];return B(b,function(a){var b=X[a];b&&o(b)&&d.push(b)}),d}function i(a,b){var c=[],d=[];B(X,function(d,e){if(!z(a,e)){var f=j(d.magicWords,b);f!==fb.noMatch&&(c[f]=c[f]||[],c[f].push(e))}});for(var e=c.length;e>0;e--){var f=c[e-1];f&&(d=d.concat(f))}return d}function j(a,b){var c=fb.noMatch;return B(a,function(a){var d=k(a,b);return d>c&&(c=d),c!==fb.equals}),c}function k(a,b){return a=(""+a).toLowerCase(),b=(""+b).toLowerCase(),b.length>a.length?fb.noMatch:a===b?fb.equals:0===a.indexOf(b)?fb.startsWith:-1!==a.indexOf(" "+b)?fb.wordStartsWith:-1!==a.indexOf(b)?fb.contains:1===b.length?fb.noMatch:-1!==l(a).indexOf(b)?fb.acronym:m(a,b)}function l(a){var b="",c=a.split(" ");return B(c,function(a){var c=a.split("-");B(c,function(a){b+=a.substr(0,1)})}),b}function m(a,b){for(var c=0,d=0;d<b.length;d++){for(var e=b[d],f=!1,g=c;g<a.length;g++){var h=a[g];if(h===e){f=!0,c=g+1;break}}if(!f)return fb.noMatch}return fb.matches}function n(a,b){if(E(a)||(a=X[a]),I(a)){var c=h(b);c.length>0&&(a=c[0])}return a&&X[a.id]&&a.action&&o(a)?(a.action(a,b),a.data.timesMade++,I(b)||q(a,b),a):null}function o(a){function b(a){return a=t(a),1===a.length?a[0]===$[0]:void 0}return b(_)||b(a.context)||a.context===_||p(a,_)}function p(a,b){var c=!1,d=a.context.any||[],e=a.context.all||[],f=a.context.none||[];if(D(a.context)?d=[a.context]:C(a.context)&&(d=a.context),e||f||d){var g=A(d)||w(b,d),h=b.length>=e.length&&y(b,e),i=x(b,f);c=g&&h&&i}return c}function q(a,b){Z[b]=Z[b]||[];var c=a.id,d=Z[b],e=d.indexOf(c);if(0!==e){if(-1!==e&&d.splice(e,1),1!==e&&d.length>0){var f=d[0];d[0]=c,c=f}d.unshift(c)}}function r(a){var b={add:[],remove:[]};return B(ab,function(c){var d=!1,e=t(c.contexts),f=t(c.regexes),g=t(c.paths);B(f,function(c){c.lastIndex=0;var f=c.exec(a);if(f&&f.length>0){var g=[];B(e,function(a){var b=a.replace(eb,function(a,b){return f[b]});g.push(b)}),b.add=b.add.concat(g),d=!0}return!d}),d||(B(g,function(c){return a===c&&(b.add=b.add.concat(e),d=!0),!d}),d||(b.remove=b.remove.concat(e)))}),b}function s(){var a=[];return B(ab,function(b){var c=b.contexts;B(c,function(b){if(eb.test(b)){var c=b.replace(eb,".+?");B(_,function(b){new RegExp(c).test(b)&&a.push(b)})}})}),a}function t(a){return a?C(a)?a:[a]:[]}function u(a,b){b=t(b);for(var c=0;c<b.length;c++)a.indexOf(b[c])<0&&a.push(b[c])}function v(a,b){b=t(b);for(var c=0;c<a.length;)z(b,a[c])?a.splice(c,1):c++}function w(a,b){a=t(a),b=t(b);for(var c=0;c<b.length;c++)if(z(a,b[c]))return!0;return!1}function x(a,b){a=t(a),b=t(b);for(var c=0;c<b.length;c++)if(z(a,b[c]))return!1;return!0}function y(a,b){a=t(a),b=t(b);for(var c=0;c<b.length;c++)if(!z(a,b[c]))return!1;return!0}function z(a,b){return a.indexOf(b)>-1}function A(a){return I(a)?!0:C(a)?0===a.length:F(a)?!1:!1}function B(a,b){var c;if(F(a)&&(a=t(a)),C(a))for(var d=0;d<a.length&&(c=b(a[d],d,a),"boolean"!=typeof c||c);d++);else for(var e in a)if(a.hasOwnProperty(e)&&(c=b(a[e],e,a),"boolean"==typeof c&&!c))break}function C(a){return a instanceof Array}function D(a){return"string"==typeof a}function E(a){return"object"==typeof a}function F(a){switch(typeof a){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}function G(a){return"undefined"==typeof a}function H(a){return null===a}function I(a){return H(a)||G(a)}function J(a){return a&&(a.wishes&&(a.noWishMerge?X=a.wishes:K(a.wishes)),Y=a.previousId||Y,Z=a.enteredMagicWords||Z,_=a.context||_,bb=a.previousContext||bb,cb=a.enabled||cb,db=a.returnOnDisabled||db),{wishes:X,previousId:Y,enteredMagicWords:Z,context:_,previousContext:bb,enabled:cb}}function K(a){return B(a,function(a,b){a.id=b,!a.action&&X[b]&&(a.action=X[b].action),a.action&&(X[b]=a)}),X}function L(a){return void 0!==a&&(bb=_,"string"==typeof a&&(a=[a]),_=a),_}function M(a){return bb=_,u(_,a),_}function N(a){return bb=_,v(_,a),A(L)&&(_=$),_}function O(){return L(bb)}function P(){return L($)}function Q(a,b){if(a){var c=r(a),e=c.add,f=s();f=f.concat(c.remove),N(f),b||d(f),M(e)}return _}function R(a){return u(ab,a),ab}function S(a){return v(ab,a),ab}function T(a){return void 0!==a&&(cb=a),cb}function U(a){return void 0!==a&&(db=a),db}function V(a,b){return function(){return cb||a===T?a.apply(this,arguments):db?b:null}}var W=null,X={},Y=0,Z={},$=["universe"],_=$,ab=[],bb=$,cb=!0,db=!0,eb=/\{\{(\d+)\}\}/,fb={equals:6,startsWith:5,wordStartsWith:4,contains:3,acronym:2,matches:1,noMatch:0};return W=V(a,{}),W.getWishes=V(e,[]),W.getWish=V(f,{}),W.getMatchingWishes=V(h,[]),W.makeWish=V(n,{}),W.options=V(J,{}),W.mergeWishes=V(K,{}),W.deregisterWish=V(c,{}),W.deregisterWishesWithContext=V(d,[]),W.reset=V(g,{}),W.context=V(L,[]),W.addContext=V(M,[]),W.removeContext=V(N,[]),W.revertContext=V(O,[]),W.restoreContext=V(P,[]),W.updatePathContext=V(Q,[]),W.addPathContext=V(R,[]),W.removePathContext=V(S,[]),W.enabled=V(T,!1),W.returnOnDisabled=V(U,!0),W});