//     genie.js
//     (c) 2013 Kent C. Dodds
//     genie.js may be freely distributed under the MIT license.
//     http://www.github.com/kentcdodds/genie.git
!function(a){function e(){return"q-"+c++}function f(a,c,d,g){if(!Array.isArray(a)){if("object"==typeof a)return f(a.magicWords,a.action,a.data,a.id);a=[a]}void 0===g&&(g=e());var h={id:g,data:d,magicWords:a,action:c};return b[g]=h,b[g]}function g(a){"object"==typeof a&&a.id&&(a=a.id);var c=b[a];delete b[a];for(var e in d)-1!=d[e].indexOf(a)&&d[e].splice(d[e].indexOf(a),1);return c}function h(){b={},d={}}function i(a){var c,e,f,g;for(e=d[a]||[],c=j(e,a),e=e.concat(c),f=[],g=0;g<e.length;g++)f.push(b[e[g]]);return f}function j(a,c){var d=[],e=[],f=[];for(var g in b)if(-1==a.indexOf(g)){var h=b[g],i=k(h.magicWords,c);switch(i){case"contains":d.push(g);break;case"acronym":e.push(g);break;case"matches":f.push(g);break;case"":}}return d.concat(e).concat(f)}function k(a,b){for(var c="",d=0;d<a.length;d++){var e=l(a[d],b);if(("contains"===e||"acronym"===e&&(""===c||"matches"===c)||"matches"===e&&""===c)&&(c=e),"contains"===c)break}return c}function l(a,b){var c,d,e="";if(a=a.toLowerCase(),b=b.toLowerCase(),b.length>a.length)return"";if(-1!=a.indexOf(b))return"contains";if(1==b.length)return"";c=a.split(" ");for(var f=0;f<c.length;f++){d=c[f].split("-");for(var g=0;g<d.length;g++)e+=d[g].substr(0,1)}return-1!=e.indexOf(b)?"acronym":m(a,b)}function m(a,b){for(var c=0,d=0;d<b.length;d++){for(var e=b[d],f=!1,g=c;g<a.length;g++){var h=a[g];if(h==e){f=!0,c=g+1;break}}if(!f)return""}return"matches"}function n(a,c){if("object"==typeof a&&a.id&&(a=a.id),null===a||void 0===a){var e=i(c);e.length>0&&(a=e[0].id)}if(b[a]&&b[a].action&&b[a].action(b[a]),void 0!==c){d[c]=d[c]||[];var f=d[c],g=f.indexOf(a);if(-1!=g&&f.splice(g,1),1!=g&&f.length>0){var h=f[0];f[0]=a,a=h}f.unshift(a)}}function o(a){return a&&(b=a.wishes||b,c=a.previousId||c,d=a.enteredKeyWords||d),{wishes:b,previousId:c,enteredMagicWords:d}}var b={},c=0,d={};a.genie=f,a.genie.getMatchingWishes=i,a.genie.makeWish=n,a.genie.options=o,a.genie.deregisterWish=g,a.genie.clearWishes=h}(this);