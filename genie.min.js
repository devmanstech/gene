/** 
 * genie - v0.2.2 @license
 * (c) 2013-12-20 - Kent C. Dodds <kent@doddsfamily.us>
 * A JavaScript library committed to improving user experience by empowering users to interact with web apps using the keyboard (better than cryptic shortcuts).
 * Freely distributed under the MIT license
 * https://github.com/kentcdodds/genie
 */
!function(a,b){"function"==typeof define&&define.amd?define(b):a.genie=b()}(this,function(){function a(){return"g-"+B++}function b(d,e,f,g,h){if(Array.isArray(d)){if("object"==typeof d[0]){for(var i=[],j=0;j<d.length;j++)i.push(b(d[j]));return i}}else{if("object"==typeof d)return b(d.magicWords,d.action,d.context,d.data,d.id);d=[d]}void 0===h&&(h=a());for(var j=0;j<d.length;j++)if("object"==typeof d[j])throw"Cannot make an object a magic word!\n"+JSON.stringify(d,null,2);e=c(e);var k={id:h,context:f||D,data:g,magicWords:d,action:e};return A[h]=k,A[h]}function c(a){return"function"==typeof a?a:("string"==typeof a&&(a={destination:a}),function(){a.openNewTab?window.open(a.destination,"_blank"):window.location.href=a.destination})}function d(a){"object"==typeof a&&a.id&&(a=a.id);var b=A[a];delete A[a];for(var c in C)-1!=C[c].indexOf(a)&&C[c].splice(C[c].indexOf(a),1);return b}function e(a){var b=[];for(var c in A)n(A[c],a)&&b.push(d(A[c]));return b}function f(){var a=p();return p({wishes:{},noWishMerge:!0,previousId:0,enteredMagicWords:[],context:D,previousContext:D,enabled:!0}),a}function g(a){var b,c,d,e,f;if(void 0===a)a="";else{if(null===a)return[];if("object"==typeof a)throw"Cannot match wishes to an object!\n"+JSON.stringify(a,null,2)}for(c=C[a]||[],b=h(c,a),c=c.concat(b),d=[],e=0;e<c.length;e++)f=A[c[e]],f&&m(f)&&d.push(f);return d}function h(a,b){var c=[],d=[];for(var e in A)if(-1==a.indexOf(e)){var f=A[e],g=i(f.magicWords,b);g!==I.noMatch&&(c[g]=c[g]||[],c[g].push(e))}for(var h=c.length;h>0;h--){var j=c[h-1];j&&(d=d.concat(j))}return d}function i(a,b){for(var c=I.noMatch,d=0;d<a.length;d++){var e=j(a[d],b);if(e>c&&(c=e),c===I.equals)break}return c}function j(a,b){var c,d,e,f,g="";if(a=(""+a).toLowerCase(),b=(""+b).toLowerCase(),b.length>a.length)return I.noMatch;if(a===b)return I.equals;if(0===a.indexOf(b))return I.startsWith;if(-1!==a.indexOf(" "+b))return I.wordStartsWith;if(-1!==a.indexOf(b))return I.contains;if(1===b.length)return I.noMatch;for(c=a.split(" "),e=0;e<c.length;e++)for(d=c[e].split("-"),f=0;f<d.length;f++)g+=d[f].substr(0,1);return-1!=g.indexOf(b)?I.acronym:k(a,b)}function k(a,b){for(var c=0,d=0;d<b.length;d++){for(var e=b[d],f=!1,g=c;g<a.length;g++){var h=a[g];if(h==e){f=!0,c=g+1;break}}if(!f)return I.noMatch}return I.matches}function l(a,b){var c,d,e,f,h;if("object"!=typeof a&&(a=A[a]),(null===a||void 0===a)&&(h=g(b),h.length>0&&(a=h[0])),!(a&&A[a.id]&&a.action&&m(a)))return null;if(a.action(a),void 0!==b){if(C[b]=C[b]||[],c=a.id,d=C[b],e=d.indexOf(c),0===e)return a;-1!=e&&d.splice(e,1),1!=e&&d.length>0&&(f=d[0],d[0]=c,c=f),d.unshift(c)}return a}function m(a){var b=E===D,c=a.context===D,d=a.context===E;return b||c||d?!0:n(a,E)}function n(a,b){b=o(b);var c=!1,d=!1;if("string"==typeof a.context)c=b.indexOf(a.context)>-1;else if(a.context instanceof Array)for(var e=0;e<b.length;e++)if(a.context.indexOf(b[e])>-1){c=!0;break}return c||d}function o(a){return a?a instanceof Array?a:[a]:[]}function p(a){return a&&(a.wishes&&(a.noWishMerge?A=a.wishes:q(a.wishes)),B=a.previousId||B,C=a.enteredMagicWords||C,E=a.context||E,F=a.previousContext||F,G=a.enabled||G,H=a.returnOnDisabled||H),{wishes:A,previousId:B,enteredMagicWords:C,context:E,previousContext:F,enabled:G}}function q(a){var b;for(var c in a)b=a[c],b.action||A[c]&&(b.action=A[c].action),b.action&&(A[c]=b);return A}function r(a){return void 0!==a&&(F=E,"string"==typeof a&&(a=[a]),E=a),E}function s(a){F=E,a=o(a);for(var b=0;b<a.length;b++)E.indexOf(a[b])<0&&E.push(a[b])}function t(a){F=E;for(var b,c=a instanceof Array,d=0;d<E.length;)b=E[d],c&&a.indexOf(b)>-1||b===a?E.splice(d,1):d++;E.length||(E=D)}function u(){return r(F)}function v(){return r(D)}function w(a){return void 0!==a&&(G=a),G}function x(a){return void 0!==a&&(H=a),H}function y(a,b){return function(){return G||a===w?a.apply(this,arguments):H?b:null}}var z=null,A={},B=0,C={},D=["universe"],E=D,F=D,G=!0,H=!0,I={equals:6,startsWith:5,wordStartsWith:4,contains:3,acronym:2,matches:1,noMatch:0};return z=y(b,{}),z.getMatchingWishes=y(g,[]),z.makeWish=y(l,{}),z.options=y(p,{}),z.mergeWishes=y(q,{}),z.deregisterWish=y(d,{}),z.deregisterWishesWithContext=y(e,[]),z.reset=y(f,{}),z.context=y(r,""),z.addContext=y(s,""),z.removeContext=y(t,""),z.revertContext=y(u,""),z.restoreContext=y(v,""),z.enabled=y(w,!1),z.returnOnDisabled=y(x,!0),z});