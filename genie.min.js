/** 
 * genie - v0.2.1 @license
 * (c) 2013-12-19 - Kent C. Dodds <kent@doddsfamily.us>
 * A JavaScript library committed to improving user experience by empowering users to interact with web apps using the keyboard (better than cryptic shortcuts).
 * Freely distributed under the MIT license
 * https://github.com/kentcdodds/genie
 */
!function(a,b){"function"==typeof define&&define.amd?define(b):a.genie=b()}(this,function(){function a(){return"g-"+y++}function b(d,e,f,g,h){if(Array.isArray(d)){if("object"==typeof d[0]){for(var i=[],j=0;j<d.length;j++)i.push(b(d[j]));return i}}else{if("object"==typeof d)return b(d.magicWords,d.action,d.context,d.data,d.id);d=[d]}void 0===h&&(h=a());for(var j=0;j<d.length;j++)if("object"==typeof d[j])throw"Cannot make an object a magic word!\n"+JSON.stringify(d,null,2);e=c(e);var k={id:h,context:f||A,data:g,magicWords:d,action:e};return x[h]=k,x[h]}function c(a){return"function"==typeof a?a:("string"==typeof a&&(a={destination:a}),function(){a.openNewTab?window.open(a.destination,"_blank"):window.location.href=a.destination})}function d(a){"object"==typeof a&&a.id&&(a=a.id);var b=x[a];delete x[a];for(var c in z)-1!=z[c].indexOf(a)&&z[c].splice(z[c].indexOf(a),1);return b}function e(){var a=m();return m({wishes:{},noWishMerge:!0,previousId:0,enteredMagicWords:[],context:A,previousContext:A,enabled:!0}),a}function f(a){var b,c,d,e,f;if(void 0===a)a="";else{if(null===a)return[];if("object"==typeof a)throw"Cannot match wishes to an object!\n"+JSON.stringify(a,null,2)}for(c=z[a]||[],b=g(c,a),c=c.concat(b),d=[],e=0;e<c.length;e++)f=x[c[e]],f&&l(f)&&d.push(f);return d}function g(a,b){var c=[],d=[];for(var e in x)if(-1==a.indexOf(e)){var f=x[e],g=h(f.magicWords,b);g!==F.noMatch&&(c[g]=c[g]||[],c[g].push(e))}for(var i=c.length;i>0;i--){var j=c[i-1];j&&(d=d.concat(j))}return d}function h(a,b){for(var c=F.noMatch,d=0;d<a.length;d++){var e=i(a[d],b);if(e>c&&(c=e),c===F.equals)break}return c}function i(a,b){var c,d,e,f,g="";if(a=(""+a).toLowerCase(),b=(""+b).toLowerCase(),b.length>a.length)return F.noMatch;if(a===b)return F.equals;if(0===a.indexOf(b))return F.startsWith;if(-1!==a.indexOf(" "+b))return F.wordStartsWith;if(-1!==a.indexOf(b))return F.contains;if(1===b.length)return F.noMatch;for(c=a.split(" "),e=0;e<c.length;e++)for(d=c[e].split("-"),f=0;f<d.length;f++)g+=d[f].substr(0,1);return-1!=g.indexOf(b)?F.acronym:j(a,b)}function j(a,b){for(var c=0,d=0;d<b.length;d++){for(var e=b[d],f=!1,g=c;g<a.length;g++){var h=a[g];if(h==e){f=!0,c=g+1;break}}if(!f)return F.noMatch}return F.matches}function k(a,b){var c,d,e,g,h;if("object"!=typeof a&&(a=x[a]),(null===a||void 0===a)&&(h=f(b),h.length>0&&(a=h[0])),!(a&&x[a.id]&&a.action&&l(a)))return null;if(a.action(a),void 0!==b){if(z[b]=z[b]||[],c=a.id,d=z[b],e=d.indexOf(c),0===e)return a;-1!=e&&d.splice(e,1),1!=e&&d.length>0&&(g=d[0],d[0]=c,c=g),d.unshift(c)}return a}function l(a){var b=B===A,c=a.context===A,d=a.context===B;if(b||c||d)return!0;var e=!1,f=!1;if("string"==typeof a.context)e=B.indexOf(a.context)>-1;else if(a.context instanceof Array)for(var g=0;g<B.length;g++)if(a.context.indexOf(B[g])>-1){e=!0;break}return e||f}function m(a){return a&&(a.wishes&&(a.noWishMerge?x=a.wishes:n(a.wishes)),y=a.previousId||y,z=a.enteredMagicWords||z,B=a.context||B,C=a.previousContext||C,D=a.enabled||D,E=a.returnOnDisabled||E),{wishes:x,previousId:y,enteredMagicWords:z,context:B,previousContext:C,enabled:D}}function n(a){var b;for(var c in a)b=a[c],b.action||x[c]&&(b.action=x[c].action),b.action&&(x[c]=b);return x}function o(a){return void 0!==a&&(C=B,"string"==typeof a&&(a=[a]),B=a),B}function p(a){C=B,a instanceof Array?B=B.concat(a):B.push(a)}function q(a){C=B;for(var b,c=a instanceof Array,d=0;d<B.length;)b=B[d],c&&a.indexOf(b)>-1||b===a?B.splice(d,1):d++;B.length||(B=A)}function r(){return o(C)}function s(){return o(A)}function t(a){return void 0!==a&&(D=a),D}function u(a){return void 0!==a&&(E=a),E}function v(a,b){return function(){return D||a===t?a.apply(this,arguments):E?b:null}}var w=null,x={},y=0,z={},A=["universe"],B=A,C=A,D=!0,E=!0,F={equals:6,startsWith:5,wordStartsWith:4,contains:3,acronym:2,matches:1,noMatch:0};return w=v(b,{}),w.getMatchingWishes=v(f,[]),w.makeWish=v(k,{}),w.options=v(m,{}),w.mergeWishes=v(n,{}),w.deregisterWish=v(d,{}),w.reset=v(e,{}),w.context=v(o,""),w.addContext=v(p,""),w.removeContext=v(q,""),w.revertContext=v(r,""),w.restoreContext=v(s,""),w.enabled=v(t,!1),w.returnOnDisabled=v(u,!0),w});