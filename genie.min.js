/** 
 * genie - v0.3.0 @license
 * (c) 2013-12-31 - Kent C. Dodds <kent@doddsfamily.us>
 * A JavaScript library committed to improving user experience by empowering users to interact with web apps using the keyboard (better than cryptic shortcuts).
 * Freely distributed under the MIT license
 * https://github.com/kentcdodds/genie
 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b):a.genie=b()}(this,function(){"use strict";function a(c){if(E(c)){var d=[];return D(c,function(b){d.push(a(b))}),d}var e=c.id||"g-"+$++,f={id:e,context:c.context||ab,data:c.data||{},magicWords:v(c.magicWords),action:b(c.action)};return f.data.timesMade=0,Z[e]=f,Z[e]}function b(a){return F(a)&&(a={destination:a}),G(a)?function(){a.openNewTab?window.open(a.destination,"_blank"):window.location.href=a.destination}:a}function c(a){G(a)&&a.id&&(a=a.id);var b=Z[a];return delete Z[a],D(_,function(b,c){-1!==b.indexOf(a)&&_[c].splice(b.indexOf(a),1),_[c].length||delete _[c]}),b}function d(a,b,d){var e=f(a,b,d);return D(e,function(a,b){e[b]=c(a)}),e}function e(a){a=a||ab;var b=[];return D(Z,function(c){(p(a)||p(c.context)||r(c,a))&&b.push(c)}),b}function f(a,b,c){var d=[];return b=b||"any",D(Z,function(e){var f=[];if(c){if(c=v(c),!B(c,"any")&&(F(e.context)||E(e.context)))return;D(c,function(a){e.context[a]&&(f=f.concat(e.context[a]))})}else G(e.context)&&(f=[],e.context.all&&(f=f.concat(v(e.context.all))),e.context.any&&(f=f.concat(v(e.context.any))),e.context.none&&(f=f.concat(v(e.context.none))));C(f)&&(F(e.context)?f=[e.context]:E(e.context)&&(f=e.context)),C(f)||("all"===b&&A(f,a)||"none"===b&&z(f,a)||"any"===b&&y(f,a))&&d.push(e)}),d}function g(a){if(E(a)){var b=[];return D(a,function(a){b.push(Z[a])}),b}return Z[a]}function h(){var a=L();return L({wishes:{},noWishMerge:!0,previousId:0,enteredMagicWords:{},context:ab,previousContext:ab,enabled:!0}),a}function i(a){a=a||"";var b=_[a]||[],c=j(b,a);b=b.concat(c);var d=[];return D(b,function(a){var b=Z[a];b&&q(b)&&d.push(b)}),d}function j(a,b){var c=[],d=[];D(Z,function(d,e){if(!B(a,e)){var f=k(d.magicWords,b);f!==hb.noMatch&&(c[f]=c[f]||[],c[f].push(e))}});for(var e=c.length;e>0;e--){var f=c[e-1];f&&(d=d.concat(f))}return d}function k(a,b){var c=hb.noMatch;return D(a,function(a){var d=l(a,b);return d>c&&(c=d),c!==hb.equals}),c}function l(a,b){return a=(""+a).toLowerCase(),b=(""+b).toLowerCase(),b.length>a.length?hb.noMatch:a===b?hb.equals:0===a.indexOf(b)?hb.startsWith:-1!==a.indexOf(" "+b)?hb.wordStartsWith:-1!==a.indexOf(b)?hb.contains:1===b.length?hb.noMatch:-1!==m(a).indexOf(b)?hb.acronym:n(a,b)}function m(a){var b="",c=a.split(" ");return D(c,function(a){var c=a.split("-");D(c,function(a){b+=a.substr(0,1)})}),b}function n(a,b){for(var c=0,d=0;d<b.length;d++){for(var e=b[d],f=!1,g=c;g<a.length;g++){var h=a[g];if(h===e){f=!0,c=g+1;break}}if(!f)return hb.noMatch}return hb.matches}function o(a,b){if(G(a)||(a=Z[a]),K(a)){var c=i(b);c.length>0&&(a=c[0])}return a&&Z[a.id]&&a.action&&q(a)?(a.action(a,b),a.data.timesMade++,K(b)||s(a,b),a):null}function p(a){return a=v(a),1===a.length?a[0]===ab[0]:!1}function q(a){return p(bb)||p(a.context)||a.context===bb||r(a,bb)}function r(a,b){var c=!1,d=a.context.any||[],e=a.context.all||[],f=a.context.none||[];if(F(a.context)?d=[a.context]:E(a.context)&&(d=a.context),e||f||d){var g=C(d)||y(b,d),h=b.length>=e.length&&A(b,e),i=z(b,f);c=g&&h&&i}return c}function s(a,b){_[b]=_[b]||[];var c=a.id,d=_[b],e=d.indexOf(c);if(0!==e){if(-1!==e&&d.splice(e,1),1!==e&&d.length>0){var f=d[0];d[0]=c,c=f}d.unshift(c)}}function t(a){var b={add:[],remove:[]};return D(cb,function(c){var d=!1,e=v(c.contexts),f=v(c.regexes),g=v(c.paths);D(f,function(c){c.lastIndex=0;var f=c.exec(a);if(f&&f.length>0){var g=[];D(e,function(a){var b=a.replace(gb,function(a,b){return f[b]});g.push(b)}),b.add=b.add.concat(g),d=!0}return!d}),d||(D(g,function(c){return a===c&&(b.add=b.add.concat(e),d=!0),!d}),d||(b.remove=b.remove.concat(e)))}),b}function u(){var a=[];return D(cb,function(b){var c=b.contexts;D(c,function(b){if(gb.test(b)){var c=b.replace(gb,".+?");D(bb,function(b){new RegExp(c).test(b)&&a.push(b)})}})}),a}function v(a){return a?E(a)?a:[a]:[]}function w(a,b){b=v(b);for(var c=0;c<b.length;c++)a.indexOf(b[c])<0&&a.push(b[c])}function x(a,b){b=v(b);for(var c=0;c<a.length;)B(b,a[c])?a.splice(c,1):c++}function y(a,b){a=v(a),b=v(b);for(var c=0;c<b.length;c++)if(B(a,b[c]))return!0;return!1}function z(a,b){a=v(a),b=v(b);for(var c=0;c<b.length;c++)if(B(a,b[c]))return!1;return!0}function A(a,b){a=v(a),b=v(b);for(var c=0;c<b.length;c++)if(!B(a,b[c]))return!1;return!0}function B(a,b){return a.indexOf(b)>-1}function C(a){return K(a)?!0:E(a)?0===a.length:H(a)?!1:!1}function D(a,b){var c;if(H(a)&&(a=v(a)),E(a))for(var d=0;d<a.length&&(c=b(a[d],d,a),"boolean"!=typeof c||c);d++);else for(var e in a)if(a.hasOwnProperty(e)&&(c=b(a[e],e,a),"boolean"==typeof c&&!c))break}function E(a){return a instanceof Array}function F(a){return"string"==typeof a}function G(a){return"object"==typeof a}function H(a){switch(typeof a){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}function I(a){return"undefined"==typeof a}function J(a){return null===a}function K(a){return J(a)||I(a)}function L(a){return a&&(a.wishes&&(a.noWishMerge?Z=a.wishes:M(a.wishes)),$=a.previousId||$,_=a.enteredMagicWords||_,bb=a.context||bb,db=a.previousContext||db,eb=a.enabled||eb,fb=a.returnOnDisabled||fb),{wishes:Z,previousId:$,enteredMagicWords:_,context:bb,previousContext:db,enabled:eb}}function M(a){return D(a,function(a,b){a.id=b,!a.action&&Z[b]&&(a.action=Z[b].action),a.action&&(Z[b]=a)}),Z}function N(a){return void 0!==a&&(db=bb,"string"==typeof a&&(a=[a]),bb=a),bb}function O(a){return db=bb,w(bb,a),bb}function P(a){return db=bb,x(bb,a),C(N)&&(bb=ab),bb}function Q(){return N(db)}function R(){return N(ab)}function S(a,b){if(a){var c=t(a),e=c.add,f=u();f=f.concat(c.remove),P(f),b||d(f),O(e)}return bb}function T(a){return w(cb,a),cb}function U(a){return x(cb,a),cb}function V(a){return void 0!==a&&(eb=a),eb}function W(a){return void 0!==a&&(fb=a),fb}function X(a,b){return function(){return eb||a===V?a.apply(this,arguments):fb?b:null}}var Y=null,Z={},$=0,_={},ab=["universe"],bb=ab,cb=[],db=ab,eb=!0,fb=!0,gb=/\{\{(\d+)\}\}/,hb={equals:6,startsWith:5,wordStartsWith:4,contains:3,acronym:2,matches:1,noMatch:0};return Y=X(a,{}),Y.getWishesInContext=X(e,[]),Y.getWishesWithContext=X(f,[]),Y.getWish=X(g,{}),Y.getMatchingWishes=X(i,[]),Y.makeWish=X(o,{}),Y.options=X(L,{}),Y.mergeWishes=X(M,{}),Y.deregisterWish=X(c,{}),Y.deregisterWishesWithContext=X(d,[]),Y.reset=X(h,{}),Y.context=X(N,[]),Y.addContext=X(O,[]),Y.removeContext=X(P,[]),Y.revertContext=X(Q,[]),Y.restoreContext=X(R,[]),Y.updatePathContext=X(S,[]),Y.addPathContext=X(T,[]),Y.removePathContext=X(U,[]),Y.enabled=X(V,!1),Y.returnOnDisabled=X(W,!0),Y});